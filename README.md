# Домашнее задание  
## Репликация и масштабирование. Часть 2

Студент: Константин Морозов

---

## Задание 1  
### Преимущества масштабирования

### 1. Активный master-сервер и пассивный репликационный slave-сервер

**Преимущества:**
- Повышение отказоустойчивости: slave может быть использован для восстановления данных при сбое master.
- Снижение нагрузки на master за счёт выполнения read-запросов на slave.
- Возможность резервного копирования без влияния на основной сервер.
- Простота реализации по сравнению с более сложными схемами масштабирования.

**Недостатки (для понимания):**
- Все write-запросы идут только на master.
- Slave не может обслуживать запись.

---

### 2. Master-сервер и несколько slave-серверов

**Преимущества:**
- Горизонтальное масштабирование чтения (read scaling).
- Существенное снижение нагрузки на master.
- Возможность распределять нагрузку между slave-серверами (балансировка).
- Повышенная отказоустойчивость: выход одного slave не влияет на систему.
- Возможность геораспределения (slave ближе к пользователям).

**Недостатки:**
- Усложнение архитектуры.
- Задержки репликации (replication lag).

---

## Задание 2  
### План горизонтального и вертикального шаринга базы данных

Исходная база данных содержит таблицы:
- `users`
- `books`
- `shops`

---

### Вертикальный шаринг

Вертикальный шаринг представляет собой метод логического разделения базы данных по функциональному или предметному признаку. При этом различные группы таблиц размещаются в отдельных базах данных или на отдельных серверах.

**Принципы вертикального шаринга:**

- разделение данных по бизнес-доменам;

- снижение связности между подсистемами;

- независимое масштабирование отдельных компонентов;

- разграничение прав доступа и повышение безопасности.

**Применение для нашей базы данных:**

Исходная база данных содержит следующие таблицы:

- users,

- books,

- shops.

Распределение данных осуществляется следующим образом:

- база данных users_db содержит таблицу users;

- база данных catalog_db содержит таблицу books;

- база данных shops_db содержит таблицу shops.

Каждая база данных обслуживается собственным master-сервером и репликационными slave-серверами.

**Преимущества:**
- Чёткое разделение ответственности.
- Упрощение масштабирования отдельных компонентов.
- Повышение безопасности (разные политики доступа).

---

### Горизонтальный шаринг

Горизонтальный шаринг — это метод физического распределения данных одной таблицы между несколькими серверами путём разбиения строк по заданному ключу шардинга.

**Принципы горизонтального шаринга:**

- распределение строк таблицы между несколькими узлами;

- использование детерминированного ключа шардинга;

- повышение пропускной способности системы;

- возможность линейного масштабирования при росте объёма данных.

**Применение для нажей базы данных:**

- таблица users распределяется по диапазонам идентификаторов пользователей (user_id);

- таблица books распределяется по категориям книг (category_id);

- таблица shops распределяется по территориальному признаку (region).

Каждый шард представляет собой отдельную физическую базу данных или сервер.

**Преимущества:**

- повышение производительности за счёт распределения нагрузки между несколькими серверами;

- возможность линейного масштабирования при росте объёма данных;

- снижение времени выполнения запросов за счёт работы с меньшими объёмами данных на каждом узле;

- повышение отказоустойчивости системы при корректной организации шардов;

- эффективное использование вычислительных ресурсов.

---

### Блоксхема архитектуры

                     +------------------+
                     |   Application    |
                     +---------+--------+
                               |
           +-------------------+-------------------+
           |                   |                   |
 +------------------+  +------------------+  +------------------+
 |   users_db       |  |   catalog_db     |  |   shops_db       |
 |   MASTER         |  |   MASTER         |  |   MASTER         |
 |  (write/read)    |  |  (write/read)    |  |  (write/read)    |
 +--------+---------+  +--------+---------+  +--------+---------+
          |                     |                     |
 +------------------+  +------------------+  +------------------+
 | users_db_slave   |  | catalog_db_slave |  | shops_db_slave   |
 | READ ONLY        |  | READ ONLY        |  | READ ONLY        |
 +------------------+  +------------------+  +------------------+


---

### Режимы работы серверов

- **Master-серверы**
  - Принимают `INSERT`, `UPDATE`, `DELETE`
  - Отвечают за консистентность данных
- **Slave-серверы**
  - Работают в режиме `READ ONLY`
  - Используются для чтения и аналитики
- **Application**
  - Write-запросы → master
  - Read-запросы → slave

---

### Итог

Использование вертикального и горизонтального шаринга позволяет:
- Масштабировать систему под рост нагрузки
- Повысить отказоустойчивость
- Гибко управлять ресурсами
- Упростить сопровождение базы данных

